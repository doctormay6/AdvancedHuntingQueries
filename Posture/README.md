# Security Posture Hunting Queries

Clicking on the name of the query will bring you to the file for it in this git repo.

***Or try them out right away in your M365 Security tenant:***

Click on the 'ðŸ”Ž' hotlink to plug the query right into your Advanced Hunting Query page

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA22QywqCUBCG_3XQOxxcGbhvVRDVIoho4QuYSQneSLvSw_c5hbaQYXSY__yXczY6KlGhRin91FalTnShtW4_pNZYI73ldNeZ3YV2CmHkTDUnIqaK3ZyOjO9rivJkkNl7hDhWtptRTh7YSgvtmWNlIBGchv-Dr2fqBboO75qpNKz1brP7MGOq1NVy7yxX8peiBsmpVjXVy5yX3XlnGXq-D9PpgLIjVcJ7pKBJpxuwH3b8IhWVGSey921vHAze_wPAk99NhgEAAA&timeRangeId=week) [Cleartext LDAP Logins](CleartextLDAP.kusto)
- Identify clear text LDAP authentication requests to domain controllers with MDI
- Aggregate by source hostname

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA-1VTUvDQBB9Z8H_sPSkUFDPomBrD0Xxoige0yRidZtIE1MVf7xvZzfazVcLrSclhNmP2Tdvdt4kGjFyKNzSzpFhihQJ7R1HOR4x5M6Ic4UTvuf0KrgT0t5wNMM1_R_ouUDA8zG9X6GJYNACTOirBWnKlQy72MEncSLOM1lNiGXiV3GuaGe0_YY9n6vxGJJLjDFxywhP3DPoCs9iI_LX9DE4KTnmgrF5RhcYECWVSD8sFJ8DPgovgpHJ6UJGiq_NTbnbLc-nRI4cr6JSjzKvBWsSC6ZqZfbOHGKHYOeXbq6ljqaSPcaeuzxCntZcKWNkxJ3xCcTjwzH1vX1dhHKnCff3sM_5hDE3qemxcNErtDnCG-9XS6Xzf43-KY0uxxgztq-FMyIFEsvE1OJlMY86VV5VVDPO9vXer8X24_VwL3Xpuc5YrYgxUc1tJqKlOfl15b2M91s9XVf96n-O1dw2Y3Z32vpfmk2ZVbuv8Lqv6Oxno37Ly3JXXPX5lXkb7JTZx1v5gvkq6Xf8Fdr1XN9p6rKmLm__A53yPVzSt9F7_q3YdXo6kozCxnso70jRtvlUa2s9vwCjhurNXAkAAA&timeRangeId=week) [Critical Vulnerabilities](CriticalVulnerabilities.kusto)
- List all software in your environment with Critical CVEs
- Shows how many devices have each version of the software
- Indicates whether the Critical CVEs have public exploits

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA7VWwU7bQBCdcyX-weIUJNpgiJA4cEgJQjm0oCRwRYuzCVGxibxOWlA_vm9fdm1DWNODIwuYndl5M7PzdpaudCWS76LFSAFpKbkoSSAv8FtDoyWTKfTP0GTck0DOZIb1XFbcb3dbnYF1BinH3x9EyLEy-JnRcwC0mUPU3OV3X25FsTuW8gTNi6T0KeSb7MkXoqxdfhNIqYwhJcxFy0Uwuz4yMazUlIgW7y-i_ZZHZmQrDiMMkVXEDCPpyD5wEqym8lXOJMb6EPq69liO-IUsYZ_joOUkYImDceJgnDgYJ26I0wtaTqE7KM_U4PRSfApnuJBXnq2V53JP7R-c4QSW1LFPQVoSeYi17UJKBixgsb3ylj60G30CywMkjagRpBfHMc-On8TU9Gzuqs9ZI6vCMTRCdv5enJP3ivzpcHfkvs_Yck7fJlaMGc_wJth74GuackcbseIPYw3or4j6xIhJiddW5IpfQ3ZTwZqztk1_U6BlrpPVFGkresXhiWOXveM3nErFDuqt38E-ObsgF3NgmJ30tn63tyOOiZYRazMd73gCpuWqqy6PgK9QYeHu9W7Ouj5t7dv1CJ81fXK8O89kVMGVndXz1uqs-HQjtzjvXTKp19DXEd9GW1_RcoWnZdQLvr0r2P6nyn3M2i4ytfP_rWXEGboiJ97P0dA09_kduVw8dvht8B6x87iSa3yDGkv6XB0EJv2S__X84s3cZOk1nfIVOHxXTfNL572Mw7NWi3-PGhW60nkTs_n9qnJe83at2E9NH8X31E7R7YwNcP8Bsi6mEuIJAAA&timeRangeId=week) [Endpoint Security Status Report](EndpointStatusReport.kusto)
- Best practice endpoint configurations for Microsoft Defender for Endpoint deployment
- Find and fix devices out of compliance
- Identify holes in your security configuration deployment

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA62STQ6CMBCF39rEOzSu_TmDCZq4MWw8AKFEmiA1FoSFh_fN8KNxpcFMyMDrm68tMxEy3OGQMu-ZC-YdlQwlKgTMMcMDBg1yajc-ZvQdkeCiSgqv_oQrJasMFrjyKzAart1gqXzHkp2t1jkSc2WtqXju0jHMGEL-ldFOpLR0hb8wpp6kIqHqGRuGwUrDsM4ypK7ljQvUrHXaI-nN6-93fqkdemPpC6RKH1Nmg-htQoYTLakf6HDqTHr_GTG5Xp3S-S3fZDJqnY0TJ6LUys_7dZqnZvVksRJzPAEo8phwnAIAAA&timeRangeId=week) [Files With Passwords](FilesWithPasswords.kusto)
- Files with the substring "password" in the name
- Results probably contain users' passwords in plain text
- Included file extensions: .doc .docx .xls .xlsx .txt

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA81Y227bRhCd5wL9B5ovkQo5avPQS4oAVWM3DuC4riWnBYIgoCUqViyJgkg5dtCP75kzuxTJpZQgSIGAoEjuzs7tzM3uS18iuZSlTCSTsWxkISm-CvxOsHOB5wI7-h3JAGsLmWE_khFWM5nLt_INeCiXOXZyUEZYn-K3cBRDvI_xtpAVKOaO81TWXHuM92vQFtjN8aW83oKuwOpGruShO9uX7-VOfsLvj_ILno_w_Bn3FDsX8gLXoTyVBOcSyMjAYwNJW-3O5E_ofEx5amsKaREsyajxPb71mePUClcG7QpqaRorZULfRPKeaxPolYBqgjNeyuFXcG0tPpZ_4JFToDuU57D-jEg8w1skJ9i9wN3D-zlojoHtEL-Re3_J9wHup6BX7x7j_Ajff4PXCOeNv54dYGeANZOh8ufOmwP6UnG-JeqGUyRPiIFhpfcVT3SggUZOAQ-rZ1NgpfG0ZsS9pa5HWL3F9xjPIeOjSlGn74L-FfWJ3BVDy5Q4vgRNCjkpqGNyjhFp19BqAp6q8Q33HkKzBNyMJnKezZgBGmfzSmxvmCVrxlVC-0-g7xGev1c41vW5wPo9OWlGDUtdboFkxoxIypyr65DjXHXXovC1_PrVRaOPBkM_zFGLhwXXU6KXsJZ8YExU_dXByp2jWpLKR1GH8ZIzc9UXKfM8jIbf4MX_r9r0IS1BVPVpjcrVlQUu5ZsD1RgIWQVRiWrRlLXGrH-C_YIWxtC3W7P9X567pu3qs6a9kRzQ3oSVK6_IiIO8igPOlqXvsDcmVk3uTXqPw5K13KNgSK4oRU-9cVaH6IS2VTlW9_zVtMFkaY-potwpdXkF7F5DTq-V2yVQPP0EHj_s4fGH6w1nrjPke-zfJ-MRZYQeWbAKqF9WrEGTFpkmMdRkP17tXNSrK9a7MXWv6xta0OTSdbXru7KKxcw6q1cjdIcj3I9bumyzo0b0nr6PEcH7Y_WQGZegGoZR22POPyh9_QCe7n2Gv87pkxvXw1LWCNPT4627b1xH6Dgsu5VaHMFjVgV91_C9cDthpOySS2ZvVCJu1o6pZV7qWq-p3h4fgfWquavu7qsuYbYdkHMsf-HsjPZqf1edbOqLS6Rnbn70NXpObJLGLKAY12V8TswWnDAz18nbYrLJ9R2obYK94XMCPvpckkPTd_7aYH_m-n51BvHyjivYNeeU8xqC-yjPiOp7RtdNjbJNpyZmA-aDaTmCz1c13LymKs-iR1GId3L-8t7XWmAebNKF2VKtFgmnsojdLHW9zv9tkbt3v6vzrfa9E3ZzX9OyWs68YMTmro6NKpxsLr13s75i0mlMkKadnrOJLtwryknG5rG6Xe0T8Xb_UyI0zHnzajNnPddmnNQjzuN5wKq2ZI2wefJj07byb-qia7tsUIop0fKT8u6_EHZbtM-aUEfF1OI_Jtf1F7Y_zJRLRujaRdMM-k8RRZqbY1quEqpSvXY9l8Ehle48Z_0pOBsXTn69rrSf7ZZaNrumes-6mGnr9e61-D2sU1vN2qpOW4-1tYx9XuWc05Jrrlf_y3CJvXmpdV7OCFfsIiNwtY5dkO-qQrnhpJ0Qnw_07im-lNJs0xjU_TvgEfLpljI-5ok2y9q8s8uGplb_AfR_0C2EEQAA&timeRangeId=month) [Undocumented RMM Software](UndocumentedRMM.kusto)
- Lists devices with RMM software running on them
- Pulls RMM software catalogue from [GitHub](https://github.com/0x706972686f/RMM-Catalogue)
- Includes exclusion list at the top of the query to document allowed use cases

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA-1Wy47TQBDsMxL_YJlLVoq0cEaLtJAVRDwurMIBcTCOk5h14sieJBjx8dTUzPidB0QRB9Bq43l2d3VXzcy1XIsnI4lE4T-TpcSyQivH6E4WHF9wxsNvICF6nmw5kmNtitUefmecN-MF2mt8U5njN4BNj1Y9zKSysbZWWB1z1QordF9xXU77G0kYh97_Fe1Ihtz1HZZT9FOsVI25lHb1nriM-bE8Aj6N8B5rHyyumL5StDSekDEZ7wu0d_guMbMijilRxVhl9i4wo1Eez0bQyUIVzcvS9gwzGqsihnY8M4sqwIoE31cykTt88zLXGmvM2LT1hPXy5GPPvCc39FnAdsA6hzKQz-LDqlsX0pPPWHx5g5E5ELr-e9iZYmyD3W7sHTPmyxe5kuc1hK9tJC5yjXXNuhW0ojHoPCnsDuA_6uRRR6yYb9XIu-knzH_O9rMexsToaUxFIy-TlodPlismry5Ho1rN79FaIp_NWCd7vFWV-EnMMSPUfAttXZp2PrAShr9dH_VYh6y-zsAYdp2Hb9SB5twDv1PEn5BViixSVrnnInoLxnqW3VUUHv5Mtde0kXP31rItt9gq1jp1JGRD1lNxh2tn9RuxZvsq22R5AS6aflKeN4NeJVyVfnJyeckcxPKjFq3jQqXGAfZ58F-cVce_qRFzerqz8xRd3DV2_NfHv6aPup8xZpp8uMXOgP7cPaz5cUO2HVJYm1X9di6rvds9N-2T8v5u3_w7q4n6zX9Mn0NGnTHbc2a9rnfFt0H1wjIvgBWZE9JeQIa6t0TMdkidZ1bBx5k75ksrsm-ezN6I-2ozaqG-RB1-V53Hb22jnD-PqK3UbUOp3TPXccFEuf_10TzvzsXbPY0vjfsQqm4WolZ8DrceV2Tg9Mh5pcj4Tcm8GLHPwLpTTowX-H9qX6UVMyrVtm2YF6zzUO04bMdh7bfmI_dp7Q3hQy-HXxvtbGgsh2vmcmOsDVqKrfR5Wp5dbJmtj2GgOWuqk-YX4ss2QCYOAAA&timeRangeId=week) [Vulnerability Percentages](VulnerabilityPercentages.kusto)
- Pie Chart for your viewing pleasure
- Determines whether each version of every program in your environment is vulnerable, expoloitable, or neither
- Takes into account how many devices have each version of a program
- By default, account for all CVE severities